<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../paper-toast/paper-toast.html">
<link rel="import" href="../paper-button/paper-button.html">
<link rel="import" href="../paper-styles/typography.html">
<link rel="import" href="../iron-icon/iron-icon.html">
<!--<link rel="import" href="../iron-swipeable-container/iron-swipeable-container.html">-->
<link rel="import" href="iron-swipeable-container2.html">
<link rel="import" href="toast-icons.html">

<!--
`app-toast`
A swipeable, actionable, and themable.

@demo demo/index.html
-->

<dom-module id="app-toast">
  <template>
    <style>
      :host {
        
      }
      iron-swipeable-container2 {
        -moz-user-select: none;
        -ms-user-select: none;
        -webkit-user-select: none;
        user-select: none;
        cursor: default;
      }
      paper-toast {
        /*color: var(--app-toast-color);*/
        /*--paper-toast-color: var(--app-toast-color);*/
        /*background-color: var(--app-toast-bgcolor);*/
        /*--paper-toast-background-color: var(--app-toast-bgcolor);*/
        @apply --paper-font-body2;
        @apply --layout-horizontal;
        @apply --layout-center;
        @apply --app-toast;
      }
      paper-toast > span {
        @apply --layout-flex;
      }
      paper-button {
        color: var(--accent-color);
        @apply --app-toast-button;
      }
      #themeIcon {
        /*--iron-icon-fill-color: var(--app-toast-bgcolor);*/
        --iron-icon-stroke-color: var(--app-toast-color);
        margin-right: 4px;
        @apply --app-toast-theme-icon;
      }
      #closeIcon {
        --iron-icon-height: 14px;
        --iron-icon-width: 14px;
        vertical-align: super;
        margin-left: 2px;
        padding: 2px;
        @apply --app-toast-close-icon;
      }
    </style>
    
    <div id="container">
      <iron-swipeable-container2
        id="swiper"
        disabled="[[disableSwipe]]"
        on-iron-swipe="__onSwiped">
        <paper-toast id="toast" on-iron-overlay-close="__onToastClosed">
          <iron-icon id="themeIcon" icon="toast-icons:[[icon]]" hidden$="[[!icon]]"></iron-icon>
          <span>[[text]]</span>
          <paper-button id="actionButton" on-tap="_onAction" hidden$="[[!actionText]]">[[actionText]]</paper-button>
          <iron-icon id="closeIcon" icon="toast-icons:close" on-tap="_onClose" hidden$="[[!showClose]]"></iron-icon>
        </paper-toast>
      </iron-swipeable-container2>
    </div>
    
    
  </template>
  <script>
    Polymer({
      is: 'app-toast',

      properties: {
        /**
         * The icon to use from the toast-icons iconset.
         */
        icon: String,
        
        /**
         * The toast's text.
         */
        text: String,
        
        /**
         * The text of the action button.
         */
        actionText: String,
        
        showClose: {
          type: Boolean,
          value: false
        },
        
        fitBottom: {
          type: Boolean,
          value: false,
          observer: '_fitBottomChanged'
        },
        
        onAction: {
          type: Object,
          value: null
        },
        
        onClose: {
          type: Object,
          value: null
        },
        
        /**
         * Whether swiping should be disabled.
         */
        disableSwipe: {
          type: Boolean,
          value: false
        }
      },

      show: function(properties) {
        if (properties) {
          for (var property in properties) {
            if (property in this && property.indexOf('_') === -1) {
              this[property] = properties[property];
              delete properties[property];
            }
          }
        }
        
        this.$.toast.show(properties);
      },
      
      _onAction: function() {
        this.onAction && this.onAction();
      },
      
      _onClose: function() {
        this.onClose && this.onClose();
        this.$.toast.close();
      },
      
      _fitBottomChanged: function(fitBottom) {
        if (fitBottom) {
          this.$.toast.classList.add('fit-bottom');
        } else {
          this.$.toast.classList.remove('fit-bottom');
        }
      },
      
      __onSwiped: function(e, data) {
        // console.log('swiped:', data.target);
        this.$.toast.close();
        this.$.toast.style.opacity = '1';
      },
      
      __onClosed: function(e, data) {
        this.$.toast.style.transform = 'translate3d(0, 0, 0) rotate(0)';
      }
    });
  </script>
</dom-module>
