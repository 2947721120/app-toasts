<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-swipeable-container/iron-swipeable-container.html">
<link rel="import" href="app-toast.html">

<!--
`app-toast-swipeable`
A swipeable wrapper for app-toast.

@demo demo/index.html
-->

<dom-module id="app-toast-swipeable">
  <template>
    <style>
      :host {
        display: block;
      }
      /*iron-swipeable-container {*/
      /*  -moz-user-select: none;*/
      /*  -ms-user-select: none;*/
      /*  -webkit-user-select: none;*/
      /*  user-select: none;*/
      /*  cursor: default;*/
      /*}*/
    </style>
    <div id="container">
      <iron-swipeable-container
        id="swiper"
        disabled="[[disableSwipe]]"
        on-iron-swipe="__onSwiped">
        <app-toast id="toast"></app-toast>
      </iron-swipeable-container>
    </div>
  </template>
  <script>
    Polymer({
      is: 'app-toast-swipeable',

      properties: {
        /**
         * Whether swiping should be disabled.
         */
        disableSwipe: {
          type: Boolean,
          value: false
        }
      },

      show: function(properties) {
        if (properties && properties.disableSwipe !== undefined) {
          this.disableSwipe = properties.disableSwipe;
          delete properties.disableSwipe;
        }
        this.$.toast.show(properties);
      },

      __onSwiped: function(e, data) {
        console.log('swiped:', data.target);
        this.$.toast.$.toast.close();
        
        // Remove the swipeable container,
        // then add it and its children again.
        Polymer.dom(this.$.container).removeChild(this.$.swiper);
        
        var swiper = document.createElement('iron-swipeable-container');
        swiper.id = 'swiper';
        
        Polymer.dom(this.$.container).appendChild(swiper);
        this.$[swiper.id] = swiper;
        
        var toast = document.createElement('app-toast');
        toast.id = 'toast';
        

        Polymer.dom(this.$.swiper).appendChild(toast);
        this.$[toast.id] = toast;
      }
    });
  </script>
</dom-module>
